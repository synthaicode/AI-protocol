# AI協働プロトコル - 引き継ぎドキュメント

## 概要

本ドキュメントは、人間とAIの協働における原則を定義するプロトコルの設計内容をまとめたものである。

## 基本方針

### Micromanagementしない

AIへの指示は詳細な手順ではなく、**ガードレール（境界線）** で制御する。

- WHATを詳細に指示するのではなく、WHYを伝えてHOWは任せる
- 「やってはいけないこと」「確認すべき条件」を定義する
- AIの判断力と自律性を活かす

### 言葉で制御する

AIの行動ではなく、AIの**語彙**を制御する。

- 用語集で正式用語を定義
- AIは用語集の言葉で聞き返す・出力する
- 言葉が揃えば認識が揃い、行動が揃う

### ドキュメント管理はAIの責任

人間は整理が不得意。AIが担当する。

- 会話から決定事項を抽出・記録
- 適切な構造化・更新
- 人間は承認のみ

---

## ファイル構成

```
.ai/
├── PROTOCOL.md          # 全体の運用ルール（エントリーポイント）
├── SOURCE_TAGS.md       # 出所タグ仕様
├── BEHAVIOR.md          # ふるまい原則
├── REQUIREMENTS.md      # 要求→要件変換ルール
└── context/
    ├── GLOSSARY.md      # 用語集（プロジェクト単位）
    ├── {project}.md     # プロジェクト固有情報
    └── LOG.md           # ステートフル管理（決定履歴・保留事項）
```

### 各ファイルの役割

| ファイル | 内容 | 更新頻度 |
|----------|------|----------|
| PROTOCOL.md | 他ファイルの参照関係、運用の全体像 | 稀 |
| SOURCE_TAGS.md | [明示][推論][仮定][補完]の定義と運用 | 稀 |
| BEHAVIOR.md | ふるまい原則（5軸 + 用語集準拠 + エスカレーション） | 低 |
| REQUIREMENTS.md | 要求理解→制約照合→要件化の手順 | 低 |
| context/GLOSSARY.md | 正式用語、別名、定義、出所 | 中（常時監視） |
| context/LOG.md | 決定履歴、保留事項、解消済み | 高 |
| context/{project}.md | プロジェクト固有の決定事項、制約 | 高 |

---

## 出所タグ仕様

| タグ | 意味 | 扱い |
|------|------|------|
| [明示] | ユーザーから直接与えられた情報 | 確定情報 |
| [推論] | 既存情報から導出 | 引用必須（「引用文」ファイル名 L.XX） |
| [仮定] | 情報不足のため仮置き | レビュー対象 |
| [補完] | 一般知識で埋めた | 必要に応じて上書き |

---

## ふるまい原則

### Micromanagementしないための5軸

1. **WHYを伝え、HOWは任せる** - 目的・意図・背景を共有
2. **境界線を定義する** - やっていいこと/いけないこと
3. **品質基準を示す** - 完了の定義
4. **不確実性の表明を許容する** - [仮定]を使える環境
5. **エスカレーションルール** - 確認が必要な条件

### 追加原則

- **用語集準拠** - 聞き返し・出力は正式用語で
- **要求→要件変換** - 理解→照合→要件化

---

## 要求→要件変換ルール

### プロセス

```
[ユーザーの言葉] 曖昧、自由、用語集外
        ↓
    ① 要求理解（意図・目的の把握）
        ↓
    ② 制約照合（既存決定・原則との整合確認）
        ↓
    ③ 要件化（具体化・用語統一）
        ↓
[用語集準拠の要件]
```

### 確認が必要な条件

| 条件 | アクション |
|------|-----------|
| 新出用語がある | 用語確認 |
| 既存制約と矛盾 | 優先順位確認 |
| 複数解釈が可能 | 意図確認 |
| 影響範囲が大きい | 承認を求める |
| 上記に該当しない | 自律で要件化 |

---

## 用語集運用

### AIの責任

| 作業 | 内容 |
|------|------|
| 検出 | 会話から新しい用語を発見 |
| 提案 | 「この用語を追加しますか？」 |
| 統一 | ドキュメント内の用語ブレを指摘 |
| 変換禁止 | 勝手な言い換えをしない |

### 初期構築

- MDファイル、プロンプト等からAIが抽出
- 人間が承認/修正

---

## ステータス管理

### ファイルのステータス

```yaml
---
status: draft | approved | pending | outdated
created: YYYY-MM-DD
pending_reason: （pendingの場合）理由
pending_until:
  - 条件1
  - 条件2
awaiting_review:
  - レビュー対象項目1
  - レビュー対象項目2
---
```

| status | 意味 | AIの扱い |
|--------|------|----------|
| draft | 未承認 | 参照可、確定情報としては使わない |
| approved | 承認済み | 確定情報として使用 |
| pending | 保留（判断先送り） | 参照しない、条件充足で再提示 |
| outdated | 要更新 | 更新提案を出す |

### 保留事項の再提示

- 日付ベースではなく**条件ベース**
- `pending_until` の条件が満たされたらAIが能動的に再提示
- 例：「デプロイ先が決定」という条件が満たされたら、関連する保留項目を提示

---

## LOG.md の構造

```markdown
---
status: approved
---

# ログ

## 保留事項

| ID | 項目 | pending_until | 登録日 |
|----|------|---------------|--------|

## 決定履歴

| 日時 | Event | Decision | Stated Reason | 出所 |
|------|-------|----------|---------------|------|

## 解消済み

| ID | 項目 | 解消日 | 結果 |
|----|------|--------|------|
```

### ログの原則（Building Shared Memory with AI より）

- AIがログを書く
- 事実のみ記録（解釈なし）
- イベントベースで構造化
- 人間は承認のみ、作成しない

---

## 他アプローチとの差別化

### vs Spec-Kit

| 観点 | Spec-Kit | 本プロトコル |
|------|----------|-------------|
| フォーカス | 何を作るか（WHAT） | どう協働するか（関係性） |
| 制御方法 | 詳細な仕様書 | 原則 + ガードレール |
| 状態管理 | なし | LOG.mdで保持 |
| 能動性 | 受動的（清書ツール） | 能動的（条件監視・再提示） |

### vs 従来のSkill

| 観点 | 従来のSkill | 本プロトコル |
|------|------------|-------------|
| 本質 | 手続きの塊 | 状態 + 原則 + 対話 |
| 形式 | IF-THEN | 判断基準 + エスカレーション |
| 状態 | ステートレス | ステートフル（LOG.md） |

---

## 次のアクション

1. 各ファイル（PROTOCOL.md, SOURCE_TAGS.md, BEHAVIOR.md, REQUIREMENTS.md）の詳細を作成
2. context/GLOSSARY.md の初期構築（本会話から用語抽出）
3. context/LOG.md の初期構築（本会話の決定事項を記録）

---

## 用語集（初期候補）

| 正式用語 | 別名 | 定義 | 出所 |
|----------|------|------|------|
| ガードレール | 境界線 | AIの行動・判断を制約する原則 | [明示] |
| 出所タグ | - | 情報の確実性を示す分類（[明示][推論][仮定][補完]） | [明示] |
| 用語集 | glossary | 正式用語と定義の一覧 | [明示] |
| ふるまい原則 | 行動原則 | AIの判断・行動の基準 | [推論] |
| 要求 | - | ユーザーが望むこと（曖昧な形） | [補完] |
| 要件 | - | 要求を具体化・用語統一したもの | [補完] |
| pending_until | - | 保留事項の解消条件 | [明示] |
| エスカレーション | - | 人間に確認・判断を求めること | [補完] |
| Micromanagement | - | 詳細な手順を逐一指示する管理方法 | [明示] |
