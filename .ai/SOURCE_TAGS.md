---
status: draft
created: 2026-01-01
awaiting_review:
  - タグの定義の妥当性
  - 運用例の適切性
---

# 出所タグ仕様

## 概要

出所タグは、AIが扱う情報の**確実性**を明示するための分類である。

全ての情報は、その出所によって以下の4つのタグのいずれかで分類される。

## タグの定義

| タグ | 意味 | 扱い | 例 |
|------|------|------|-----|
| [明示] | ユーザーから直接与えられた情報 | 確定情報として扱う | ユーザーが「Reactを使う」と発言 |
| [推論] | 既存情報から論理的に導出 | 引用を必須とする | 「package.jsonにReactがある」から「Reactプロジェクト」 |
| [仮定] | 情報不足のため仮置き | レビュー対象、暫定的に使用 | 「デプロイ先は不明だが、Vercelと仮定」 |
| [補完] | 一般知識・ベストプラクティスで埋めた | 必要に応じて上書き可能 | 「テストフレームワークの指定なし、Jestを使用」 |

## タグの使用ルール

### [明示] - Explicit

**定義**: ユーザーが会話中で直接述べた情報

**使用例**:
- ユーザー発言: 「TypeScriptで書いてください」
- 記録: `言語: TypeScript [明示]`

**注意点**:
- ユーザーの発言そのものを記録（解釈を加えない）
- 引用元の会話IDや日時を併記することが望ましい

### [推論] - Inferred

**定義**: 既存の確定情報から論理的に導出できる情報

**使用例**:
- コードに `import React from 'react'` が存在
- 記録: `フレームワーク: React [推論] 「import React from 'react'」 src/App.tsx L.1`

**必須要件**:
- **引用元を明記** - 「引用文」ファイル名 行番号
- 推論の根拠を追跡可能にする
- 複数の情報から推論した場合は、全ての根拠を列挙

**引用形式**:
```
[推論] 「引用部分」 ファイルパス L.行番号
```

### [仮定] - Assumed

**定義**: 情報不足のため、作業を進めるために暫定的に置いた前提

**使用例**:
- ユーザー: 「ユーザー認証を追加して」
- 記録: `認証方式: JWT [仮定] （方式未指定のため）`

**運用ルール**:
- レビュー時に確認対象として提示
- `awaiting_review` に列挙
- ユーザーが承認すれば [明示] に変更
- ユーザーが訂正すれば新しい [明示] で上書き

**仮定の記載形式**:
```
項目: 値 [仮定] （仮定理由）
```

### [補完] - Complemented

**定義**: 一般的な知識やベストプラクティスで補完した情報

**使用例**:
- ユーザー: 「Node.jsプロジェクトを作って」
- 記録: `パッケージマネージャー: npm [補完] （一般的なデフォルト）`

**使用条件**:
- 業界標準・デファクトスタンダードであること
- 後で変更しても影響が小さいこと
- ユーザーの意図と矛盾しないこと

**上書きルール**:
- ユーザーが明示的に指定した場合は即座に上書き
- [補完] は [明示] に対して常に劣後

## タグの優先順位

情報が競合した場合、以下の優先順位で判断：

1. **[明示]** - 最優先、確定情報
2. **[推論]** - 根拠が明確な場合は信頼できる
3. **[仮定]** - 暫定的、レビュー対象
4. **[補完]** - 最も優先度が低い、いつでも上書き可能

## タグの変更履歴

情報の出所が変わった場合、LOG.mdに記録：

```markdown
| 日時 | Event | Decision | Stated Reason | 出所 |
|------|-------|----------|---------------|------|
| 2025-01-15 | 認証方式決定 | JWT → OAuth2.0 | セキュリティ要件 | [仮定] → [明示] |
```

## 実践例

### ケース1: 新規プロジェクト立ち上げ

ユーザー: 「Webアプリを作りたい」

AIの内部記録:
```yaml
目的: Webアプリ開発 [明示]
フレームワーク: Next.js [補完] （モダンなWebアプリの標準）
言語: TypeScript [補完] （型安全性のベストプラクティス）
デプロイ先: 未定 [仮定] （Vercelと仮定して進める）
```

AIの応答:
> Webアプリ開発を開始します。以下の前提で進めますが、変更があれば教えてください：
> - フレームワーク: Next.js
> - 言語: TypeScript
> - デプロイ先: Vercel（仮定）

### ケース2: 既存コードからの推論

コード内容:
```typescript
// src/config/database.ts
export const dbConfig = {
  host: 'localhost',
  port: 5432,
  database: 'myapp'
}
```

AIの記録:
```yaml
データベース: PostgreSQL [推論] 「port: 5432」 src/config/database.ts L.3
接続先: localhost [推論] 「host: 'localhost'」 src/config/database.ts L.2
```

### ケース3: 仮定の解消

初期状態:
```yaml
テストフレームワーク: Jest [仮定] （指定なし）
```

ユーザー: 「Vitestを使ってください」

更新後:
```yaml
テストフレームワーク: Vitest [明示]
```

LOG.mdに記録:
```markdown
| 日時 | Event | Decision | Stated Reason | 出所 |
|------|-------|----------|---------------|------|
| 2025-01-15 14:30 | テストフレームワーク決定 | Jest → Vitest | ユーザー指定 | [仮定] → [明示] |
```

## 用語集への適用

GLOSSARY.mdの各用語にも出所タグを付与：

```markdown
| 正式用語 | 別名 | 定義 | 出所 |
|----------|------|------|------|
| ガードレール | 境界線 | AIの行動・判断を制約する原則 | [明示] |
| 要求 | - | ユーザーが望むこと（曖昧な形） | [補完] |
```

## AIの責任

- 全ての情報に適切なタグを付与
- [推論] の場合は必ず引用元を明記
- [仮定] は `awaiting_review` に列挙
- タグの変更があればLOG.mdに記録

## ユーザーの責任

- [仮定] のレビューと承認/訂正
- [補完] の確認と必要に応じた変更指示
- [明示] の内容が正確に記録されているか確認
